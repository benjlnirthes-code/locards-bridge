<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        function startBridge() {
            const tg = window.Telegram.WebApp;
            tg.ready(); // Сообщаем Telegram, что приложение готово
            tg.expand();

            const params = new URLSearchParams(window.location.search);
            const target = params.get('url');

            if (target) {
                // Функция самого перехода
                const navigate = () => {
                    if (target.includes('t.me')) {
                        tg.openTelegramLink(target);
                    } else {
                        tg.openLink(target);
                    }
                };

                // Запускаем переход через небольшую паузу
                setTimeout(navigate, 500);

                // Закрываем шторку только через 7 секунд (хватит для перехода на мобилках)
                setTimeout(() => { tg.close(); }, 7000);
            }
        }
        window.onload = startBridge;
    </script>
    <style>
        body { 
            background: #1c1c1c; color: white; font-family: sans-serif; 
            display: flex; flex-direction: column; align-items: center; 
            justify-content: center; height: 100vh; margin: 0; text-align: center;
        }
        .loader { 
            border: 4px solid #333; border-top: 4px solid #f82d00; 
            border-radius: 50%; width: 40px; height: 40px; 
            animation: spin 1s linear infinite; margin-bottom: 20px;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        button {
            margin-top: 20px; background: #f82d00; color: white; border: none;
            padding: 10px 20px; border-radius: 8px; font-weight: bold; cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="loader"></div>
    <p>Загрузка задания <b>ЛоCards</b>...</p>
    <p style="font-size: 12px; color: #888;">Если переход не начался автоматически:</p>
    <button onclick="location.reload()">Перейти вручную</button>
</body>
</html>
